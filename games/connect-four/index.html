<!DOCTYPE html>
<html lang="ja">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>コネクトフォー</title>
    <style>
        body {
            font-family: 'Segoe UI', 'Arial', sans-serif;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            min-height: 100vh;
            background: linear-gradient(135deg, #232526 0%, #414345 100%);
            margin: 0;
            overflow: hidden;
        }

        h1 {
            color: #ffd700;
            font-size: 2em;
            letter-spacing: 0.08em;
            margin-bottom: 24px;
            text-shadow: 2px 2px 12px #222, 0 0 8px #fff2;
        }

        .board {
            display: grid;
            grid-template-columns: repeat(7, 90px);
            grid-template-rows: repeat(6, 90px);
            gap: 8px;
            border: 4px solid #ffd700;
            background: linear-gradient(135deg, #313a3a 60%, #232526 100%);
            box-shadow: 0 4px 18px #0008, 0 0 0 2px #ffd70044 inset;
            border-radius: 16px;
            margin: 0 auto 18px auto;
        }

        .cell {
            width: 90px;
            height: 90px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 2.8em;
            font-weight: bold;
            cursor: pointer;
            border: 1.5px solid #ffd70099;
            box-sizing: border-box;
            background: linear-gradient(135deg, #232526 60%, #313a3a 100%);
            border-radius: 50%;
            transition: background 0.18s, transform 0.18s, box-shadow 0.18s;
            box-shadow: 0 2px 8px #2226;
        }

        .cell:hover {
            background: #ffd70022;
            transform: scale(1.04);
            box-shadow: 0 4px 18px #ffd70055, 0 0 0 2px #ffd700cc inset;
        }

        .cell.red {
            background: radial-gradient(circle at 30% 30%, #ff4c4c 60%, #b71c1c 100%);
            box-shadow: 0 2px 8px #ff4c4c88, 0 0 0 2px #ffd70044 inset;
        }

        .cell.yellow {
            background: radial-gradient(circle at 30% 30%, #ffd700 70%, #b8860b 100%);
            box-shadow: 0 2px 8px #ffd70088, 0 0 0 2px #ffd70044 inset;
        }

        .cell.win {
            background: #ffeb3b;
            animation: pulse 0.8s infinite alternate;
            color: #232526 !important;
            text-shadow: 0 0 12px #ffd700, 0 0 4px #fff;
        }

        @keyframes pulse {
            from {
                transform: scale(1);
                box-shadow: 0 0 10px rgba(255, 235, 59, 0.7);
            }

            to {
                transform: scale(1.08);
                box-shadow: 0 0 24px rgba(255, 235, 59, 1);
            }
        }

        #turn-info {
            font-size: 1.1em;
            margin-bottom: 10px;
            color: #ffd700;
            text-shadow: 1px 1px 6px #222;
        }

        #reset-btn {
            margin-top: 20px;
            padding: 12px 32px;
            font-size: 1.1em;
            cursor: pointer;
            background: linear-gradient(90deg, #ffd700 60%, #b8860b 100%);
            color: #232526;
            border: none;
            border-radius: 8px;
            font-weight: bold;
            box-shadow: 0 2px 8px #2226;
            transition: background 0.3s, color 0.2s, transform 0.15s;
        }

        #reset-btn:hover {
            background: linear-gradient(90deg, #fffbe6 60%, #ffd700 100%);
            color: #000;
            transform: scale(1.07);
            box-shadow: 0 4px 18px #ffd70099, 0 0 0 2px #ffd700cc inset;
        }
    </style>
</head>

<body>
    <h1>コネクトフォー</h1>
    <div id="turn-info">赤の番</div>
    <div class="board" id="board"></div>
    <button id="reset-btn">リセット</button>
    <script>
        const ROWS = 6;
        const COLS = 7;
        let board = [];
        let turn = 'red';
        let gameOver = false;
        let winCells = [];

        function resetBoard() {
            board = Array.from({ length: ROWS }, () => Array(COLS).fill(null));
            turn = 'red';
            gameOver = false;
            winCells = [];
            render();
            document.getElementById('turn-info').textContent = '赤の番';
        }

        function render() {
            const boardDiv = document.getElementById('board');
            boardDiv.innerHTML = '';
            for (let r = 0; r < ROWS; r++) {
                for (let c = 0; c < COLS; c++) {
                    const cell = document.createElement('div');
                    cell.className = 'cell';
                    if (board[r][c]) cell.classList.add(board[r][c]);
                    if (winCells.some(([wr, wc]) => wr === r && wc === c)) cell.classList.add('win');
                    cell.dataset.col = c;
                    cell.addEventListener('click', handleCellClick);
                    boardDiv.appendChild(cell);
                }
            }
            if (gameOver && winCells.length > 0) {
                document.getElementById('turn-info').textContent = (turn === 'red' ? '赤' : '黄') + 'の勝ち！';
            } else if (gameOver) {
                document.getElementById('turn-info').textContent = '引き分け！';
            }
        }

        function handleCellClick(e) {
            if (gameOver) return;
            const col = parseInt(e.currentTarget.dataset.col);
            // 一番下の空きマスを探す
            for (let r = ROWS - 1; r >= 0; r--) {
                if (!board[r][col]) {
                    board[r][col] = turn;
                    if (checkWin(r, col)) {
                        gameOver = true;
                        render();
                        return;
                    }
                    if (board.flat().every(cell => cell)) {
                        gameOver = true;
                        render();
                        return;
                    }
                    turn = (turn === 'red') ? 'yellow' : 'red';
                    document.getElementById('turn-info').textContent = (turn === 'red' ? '赤' : '黄') + 'の番';
                    render();
                    return;
                }
            }
        }

        function checkWin(row, col) {
            const color = board[row][col];
            const directions = [
                [[0, 1], [0, -1]], // 横
                [[1, 0], [-1, 0]], // 縦
                [[1, 1], [-1, -1]], // 斜め（右下↖左上）
                [[1, -1], [-1, 1]], // 斜め（左下↗右上）
            ];
            for (const dir of directions) {
                let count = 1;
                let cells = [[row, col]];
                for (const [dr, dc] of dir) {
                    let r = row + dr, c = col + dc;
                    while (r >= 0 && r < ROWS && c >= 0 && c < COLS && board[r][c] === color) {
                        count++;
                        cells.push([r, c]);
                        r += dr;
                        c += dc;
                    }
                }
                if (count >= 4) {
                    winCells = cells;
                    return true;
                }
            }
            return false;
        }

        document.getElementById('reset-btn').addEventListener('click', resetBoard);
        resetBoard();
    </script>
</body>

</html>